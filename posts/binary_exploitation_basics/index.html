<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>- O5wald</title><meta name=Description content="Learn Share Grow"><meta property="og:title" content><meta property="og:description" content="Basics for Binary Exploitation we all know how C programs is get compiled.
first your C file goes to the compiler, then compiler convert it into sequence of operation that will be executed by computer each operation compiled into sequence of bytes called operation code or OP code Why Assembly ? trying to read the instruction that our computer executing is impossible. Assembly is Language that designed for translating the instruction that our computer will execute into human readable language."><meta property="og:type" content="article"><meta property="og:url" content="https://o5wald.github.io/posts/binary_exploitation_basics/"><meta property="og:image" content="https://o5wald.github.io/logo.png"><meta property="article:section" content="posts"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://o5wald.github.io/logo.png"><meta name=twitter:title content><meta name=twitter:description content="Basics for Binary Exploitation we all know how C programs is get compiled.
first your C file goes to the compiler, then compiler convert it into sequence of operation that will be executed by computer each operation compiled into sequence of bytes called operation code or OP code Why Assembly ? trying to read the instruction that our computer executing is impossible. Assembly is Language that designed for translating the instruction that our computer will execute into human readable language."><meta name=application-name content="This"><meta name=apple-mobile-web-app-title content="This"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://o5wald.github.io/posts/binary_exploitation_basics/><link rel=next href=https://o5wald.github.io/posts/networking_basics/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/o5wald.github.io\/posts\/binary_exploitation_basics\/"},"genre":"posts","wordcount":1549,"url":"https:\/\/o5wald.github.io\/posts\/binary_exploitation_basics\/","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=O5wald>$cd Home</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/categories/>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=O5wald>$cd Home</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX"></h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=0001-01-01>0001-01-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1549 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;8 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept=true><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#1-heap>1. Heap</a></li><li><a href=#3-stack>3. Stack</a></li></ul></li><li><a href=#x86-assembly>x86 Assembly</a><ul><li><a href=#instructions>Instructions</a></li><li><a href=#2-uaddu>2. add</a></li><li><a href=#3-usubu>3. sub</a></li><li><a href=#4-upush--popu>4. push / pop</a></li><li><a href=#5-uleau>5. lea</a></li></ul></li><li><a href=#control-flow-of-executable>Control flow of Executable</a><ul><li><a href=#1-ucmpu>1. cmp</a></li><li><a href=#2-ujumpu>2. jump</a></li><li><a href=#3-ucallu>3. call</a></li><li><a href=#4-uleave--return-u>4. leave / return</a></li><li><a href=#resource>Resource</a></li></ul></li></ul></nav></div></div><div class=content id=content><h1 id=basics-for-binary-exploitation>Basics for Binary Exploitation</h1><p>we all know how C programs is get compiled.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=http://www.btechsmartclass.com/c_programming/cp_images/program-execution-process.png data-srcset="http://www.btechsmartclass.com/c_programming/cp_images/program-execution-process.png, http://www.btechsmartclass.com/c_programming/cp_images/program-execution-process.png 1.5x, http://www.btechsmartclass.com/c_programming/cp_images/program-execution-process.png 2x" data-sizes=auto alt=http://www.btechsmartclass.com/c_programming/cp_images/program-execution-process.png title=compile></p><ul><li>first your C file goes to the compiler, then compiler convert it into sequence of operation that will be executed by computer</li><li>each operation compiled into sequence of bytes called <code>operation code</code> or <code>OP code</code></li></ul><h1 id=why-assembly->Why Assembly ?</h1><p>trying to read the instruction that our computer executing is impossible. Assembly is Language that designed for translating the instruction that our computer will execute into human readable language. In order to understand what is happening when executable is get executed , you must first understand the assembly of the executable.</p><h1 id=basic-components-of-c-program>Basic components of C program</h1><ol><li>Heap</li><li>Stack</li><li>Registers</li><li>Instructions</li></ol><p>There are mainly Two architectures in Assembly</p><ul><li>x86 (32 bit) (will be covered in this blog)</li><li>x64 (64 bit)</li></ul><h3 id=1-heap>1. Heap</h3><p>when functions like malloc(),calloc() called or the global or static are declared, or we can say the manual memory allocation this all goes to HEAP.</p><h4 id=2-registers>2. Registers</h4><p>registers is small storage areas. this registers are use to store values of addresses or variables that can be represented by 8 bytes or less than 8 bytes
there are total 6 general purpose registers:</p><ul><li><strong>eax</strong> (Primary accumulator)</li><li><strong>ebx</strong> (Base Register)</li><li><strong>ecx</strong> (Counter Register)</li><li><strong>edx</strong> (Data Register)</li><li><strong>esi</strong> (Source Index)</li><li><strong>edi</strong> (Destination Index)</li></ul><p>there are 3 registers <strong>Reserved</strong> for specific purpose</p><ul><li><strong>ebp</strong> (Base Pointer)</li><li><strong>esp</strong> (Stack Pointer)</li><li><strong>eip</strong> (Instruction Pointer)</li></ul><h3 id=3-stack>3. Stack</h3><p>The stack is data structure that contain element that can be added (push) or removed (pop)</p><ul><li><code>push</code> adds element on TOP of the stack</li><li><code>pop</code> remove element from TOP of the stack</li></ul><p>Each Stack element has its own address. Stack grows towards lower memory addresses, which means stack goes from high address values to low address values. Whenever a function is called, that function goes to the stack frame. In every stack frame there is <code>esp</code> (stack pointer) which points to TOP of the stack and <code>ebp</code>(Base pointer) which points to BASE of the stack. all the addresses outside the stack is considered as JUNK by the stack.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/hSMDJf2.png data-srcset="https://i.imgur.com/hSMDJf2.png, https://i.imgur.com/hSMDJf2.png 1.5x, https://i.imgur.com/hSMDJf2.png 2x" data-sizes=auto alt=https://i.imgur.com/hSMDJf2.png title=https://i.imgur.com/hSMDJf2.png></p><p>let&rsquo;s understand stack frame by Code and execution process.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=kt>void</span> <span class=nf>fun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=kt>int</span> <span class=n>a</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=kt>int</span> <span class=n>b</span><span class=o>=</span><span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>   <span class=n>fun</span><span class=p>(</span><span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ol><li>Now first of all in fun&rsquo;s stack frame the value of argument i.e 10 will get stored</li><li>Then the return address of function <code>fun</code></li><li>Then the memory is get allocated for variable <code>a</code> (assume 4 bytes)</li><li>Now the value of variable <code>x</code> is not directly get stored in variable <code>b</code>. the value of variable <code>x</code> first get stored in general purpose register like eax or any then the value inside that general purpose register is get stored into variable <code>b</code></li></ol><p>The stack frame will look like (Numbers in red denoting the steps to follow)</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/wjXBbN1.png data-srcset="https://i.imgur.com/wjXBbN1.png, https://i.imgur.com/wjXBbN1.png 1.5x, https://i.imgur.com/wjXBbN1.png 2x" data-sizes=auto alt=https://i.imgur.com/wjXBbN1.png title=https://i.imgur.com/wjXBbN1.png></p><h2 id=x86-assembly>x86 Assembly</h2><p>Now this section will cover how your computer execute the code.
There are 2 syntax of Assembly :</p><ol><li>AT & T</li><li>Intel</li></ol><p>we will use intel syntax in this section</p><h3 id=instructions>Instructions</h3><p>every Assembly instruction have two parts, <strong>operation</strong> followed by <strong>instruction</strong>
E.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>mov</span> <span class=nb>eax</span><span class=p>,</span><span class=mh>0x5</span>
</span></span></code></pre></div><h4 id=1-umov-u>1. mov</h4><p><code>mov</code> instruction take 2 arguments</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>mov</span> <span class=nv>arg1</span><span class=p>,</span><span class=nv>arg2</span>
</span></span></code></pre></div><p>this instruction copy the value of argument 2 to argument 1
E.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>mov</span> <span class=nb>eax</span><span class=p>,</span><span class=mh>0x5</span>
</span></span></code></pre></div><p>this is similar to <code>eax = 5</code>
Note: if we want to copy the <strong>Value</strong> of variable or register into another register we need to write the name of variable in <code>[]</code> square brackets. if we wont give square brackets, it will take the <strong>Address</strong> of variable or register
E.g. (1)
consider
eax = 0, ebx = 5
address of ebx is 0x1793</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>mov</span> <span class=nb>eax</span><span class=p>,</span><span class=nb>ebx</span>
</span></span></code></pre></div><p>this above instruction will not store the value of <code>ebx</code> to <code>eax</code>. this instruction will store <strong>the address of <code>ebx</code> i.e. <code>0x1793</code> to <code>eax</code></strong>. now <code>eax</code> will be <code>eax = 0x1793</code></p><p>E.g. (2)
consider
eax = 0, ebx = 5
address of ebx is 0x1793</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>mov</span> <span class=nb>eax</span><span class=p>,[</span><span class=nb>ebx</span><span class=p>]</span>
</span></span></code></pre></div><p>this above instruction will store the <strong>Value</strong> of <code>ebx</code> i.e. 5 to <code>eax</code>.
now <code>eax</code> will be <code>eax = 5</code></p><h3 id=2-uaddu>2. add</h3><p><code>add</code> instruction take 2 arguments</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>add</span> <span class=nv>arg1</span><span class=p>,</span><span class=nv>arg2</span>
</span></span></code></pre></div><p>this instruction add value of <code>arg2</code> to <code>arg1</code> and store it in <strong><code>arg1</code></strong>
E.g. (1)
consider
eax = 2</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>add</span> <span class=nb>eax</span><span class=p>,</span><span class=mh>0x5</span>
</span></span></code></pre></div><p>after the above instruction get executed. the value of <code>eax</code> will be
<code>eax = eax + 5</code>
i.e. <code>eax = 2 + 5</code>, so <code>eax = 7</code></p><p>E.g. (2)
consider
eax = 4
ebx = 10</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>add</span> <span class=nb>ebx</span><span class=p>,</span><span class=nb>eax</span>
</span></span></code></pre></div><p>after the above instruction get executed. the value of <code>ebx</code> will be
<code>ebx = ebx + eax</code>
i.e. <code>ebx = 10 + 4</code>, so <code>ebx = 14</code></p><h3 id=3-usubu>3. sub</h3><p><code>sub</code> instruction takes 2 arguments. it works similar as <code>add</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>sub</span> <span class=nv>arg1</span><span class=p>,</span><span class=nv>arg2</span>
</span></span></code></pre></div><p>this instruction subtract value of <code>arg2</code> to <code>arg1</code> and store it in <strong><code>arg1</code></strong>
E.g. (1)
consider
eax = 11</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>add</span> <span class=nb>eax</span><span class=p>,</span><span class=mh>0x5</span>
</span></span></code></pre></div><p>after the above instruction get executed. the value of <code>eax</code> will be
<code>eax = eax - 5</code>
i.e. <code>eax = 11 - 5</code>, so <code>eax = 6</code></p><p>E.g. (2)
consider
eax = 4
ebx = 10</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>sub</span> <span class=nb>ebx</span><span class=p>,</span><span class=nb>eax</span>
</span></span></code></pre></div><p>after the above instruction get executed. the value of <code>ebx</code> will be
<code>ebx = ebx - eax</code>
i.e. <code>ebx = 10 - 4</code>, so <code>ebx = 6</code></p><h3 id=4-upush--popu>4. push / pop</h3><p><strong><code>push</code></strong> instruction take 1 argument</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>push</span> <span class=nv>arg</span>
</span></span></code></pre></div><p>this instruction will push the <code>arg</code> to <strong>TOP</strong> of the stack
E.g.
consider
eax = 3</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>push</span> <span class=nb>eax</span>
</span></span></code></pre></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/n31FPHQ.png data-srcset="https://i.imgur.com/n31FPHQ.png, https://i.imgur.com/n31FPHQ.png 1.5x, https://i.imgur.com/n31FPHQ.png 2x" data-sizes=auto alt=https://i.imgur.com/n31FPHQ.png title=https://i.imgur.com/n31FPHQ.png></p><ul><li>when argument is given to a <code>push</code>, <code>push</code> will decrement the <code>esp</code>(stack pointer).</li><li>Note: <strong>decrement the <code>esp</code></strong> what does it mean? the stack address goes from high to low
E.g.
stack frame is from 0x1735 to 0x1720
then <code>esp</code> will start from 0x1735 and goes upto 0x1720</li></ul><hr><p><strong><code>pop</code></strong> instruction take register as argument</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>pop</span> <span class=nv>reg</span>
</span></span></code></pre></div><p>this instruction will store the value of element which is on <em>TOP</em> of the stack into <code>reg</code> then it will remove or pop that <em>TOP</em> element from the stack</p><p>E.g.
consider
the top element on the stack is 3</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>pop</span> <span class=nb>eax</span>
</span></span></code></pre></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/0owLnyE.png data-srcset="https://i.imgur.com/0owLnyE.png, https://i.imgur.com/0owLnyE.png 1.5x, https://i.imgur.com/0owLnyE.png 2x" data-sizes=auto alt=https://i.imgur.com/0owLnyE.png title=https://i.imgur.com/0owLnyE.png></p><ul><li>when argument is given to a <code>pop</code>, <code>pop</code> will store the value from top of the stack to a register that is given in argument</li><li>then <code>pop</code> will <strong>increase</strong> the <code>esp</code>(stack pointer)</li></ul><h3 id=5-uleau>5. lea</h3><p><code>lea</code> stands for <strong>load effective address</strong>. this instruction takes <em>register</em> and <em>address</em> as an argument</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>lea</span> <span class=nv>reg</span><span class=p>,</span><span class=nv>addr</span>
</span></span></code></pre></div><p>this instruction take address and store it into the given register</p><p>E.g</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>lea</span> <span class=nb>eax</span><span class=p>,</span><span class=mh>0x1739</span>
</span></span></code></pre></div><p>the address i.e <code>0x1739</code> will get stored into <code>eax</code> register.
now <code>eax</code> will be, <code>eax = 0x1739</code></p><h2 id=control-flow-of-executable>Control flow of Executable</h2><ul><li>all if statements, loops and code come together in this instructions</li><li>every instruction has instruction address</li><li><code>eip</code>(instruction pointer) contain the address of instruction that are currently being executed, then it will move to the next instruction</li></ul><h3 id=1-ucmpu>1. cmp</h3><p><code>cmp</code> is a compare instruction which takes two arguments. it work same as <code>sub</code> but rather storing the value, it will set <strong><code>flag</code></strong> in flag register
the flags will be <code>&lt;0</code> or <code>>0</code> or <code>=0</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span> <span class=nv>arg1</span><span class=p>,</span><span class=nv>arg2</span>
</span></span></code></pre></div><p>E.g (1)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span> <span class=mi>1</span><span class=p>,</span><span class=mi>3</span>
</span></span></code></pre></div><p>after execution of this instruction what happens is <code>1-3 = -2</code> so flag register will store <code>&lt;0</code>.</p><p>E.g. (2)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span> <span class=mi>5</span><span class=p>,</span><span class=mi>2</span>
</span></span></code></pre></div><p>so, <code>5-2 = 3</code> so flag register will store <code>>0</code>.</p><p>E.g. (3)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span> <span class=mi>5</span><span class=p>,</span><span class=mi>5</span>
</span></span></code></pre></div><p>so, <code>5-5 = 0</code> so flag register will store <code>0</code></p><p><strong>Note</strong>: the <code>cmp</code> (compare) instruction is always followed by <code>jmp</code> instruction</p><h3 id=2-ujumpu>2. jump</h3><p>this instruction take address as an argument</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>jmp</span> <span class=nv>addr</span>
</span></span></code></pre></div><p>this instruction will check the current state of the flag and accordingly <strong>jump</strong> <em>(jump means basically changing the value of <code>eip</code> (instruction pointer) to the given address)</em> to the address.</p><p>Types of <strong>Jump</strong> instruction:</p><ol><li><code>jne</code> -> jump not equal to</li><li><code>je</code> -> jump equal to</li><li><code>jg</code> -> jump greater than</li><li><code>jl</code> -> jump less than</li></ol><p>E.g. (1)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span> <span class=mi>1</span><span class=p>,</span><span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=nf>jl</span> <span class=nv>addr27</span>
</span></span></code></pre></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/uI9IrNa.png data-srcset="https://i.imgur.com/uI9IrNa.png, https://i.imgur.com/uI9IrNa.png 1.5x, https://i.imgur.com/uI9IrNa.png 2x" data-sizes=auto alt=https://i.imgur.com/uI9IrNa.png title=https://i.imgur.com/uI9IrNa.png></p><ul><li>when above instruction is get executed the <code>eip</code> will stop at <code>jl addr 27</code> as shown in image</li><li>now at this point the flag will got check which is <code>&lt; 0</code></li><li>so the condition is true because instruction is <code>jump less than</code>, so <code>eip</code> will go to <code>Addr 27</code> and execute the <code>instruction 27</code></li></ul><p>E.g. (2)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>cmp</span> <span class=mi>5</span><span class=p>,</span><span class=mi>2</span>
</span></span><span class=line><span class=cl><span class=nf>jl</span> <span class=nv>addr27</span>
</span></span></code></pre></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/NHqNG2i.png data-srcset="https://i.imgur.com/NHqNG2i.png, https://i.imgur.com/NHqNG2i.png 1.5x, https://i.imgur.com/NHqNG2i.png 2x" data-sizes=auto alt=https://i.imgur.com/NHqNG2i.png title=https://i.imgur.com/NHqNG2i.png></p><ul><li>when the above instruction is get executed. the <code>eip</code> will stop at <code>jl addr 27</code> as shown in image</li><li>now at this point the flag will got check which is <code>>0</code></li><li>so the condition is false because instruction is <code>jump less</code>, so <code>eip</code> will go to <code>Addr 4</code> and execute the <code>instruction 4</code></li><li>if the instruction has <code>jg</code> rather than <code>jl</code> then condition will true and <code>eip</code> will go to <code>Addr 27</code> and execute the <code>instruction 27</code></li></ul><h3 id=3-ucallu>3. call</h3><p><code>call</code> instruction calls a <strong>function</strong> whether its user defined or in built. <code>call</code> takes function as an argument</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>call</span> <span class=o>&lt;</span><span class=nv>func</span><span class=o>&gt;</span>
</span></span></code></pre></div><p>when the <code>call</code> instruction is get executed. the instruction will push the address of function to stack and jump to that first instruction</p><h3 id=4-uleave--return-u>4. leave / return</h3><p><code>leave</code> instruction always followed with <code>return</code> instruction</p><ol><li><strong><code>leave</code></strong><ul><li>leave instruction will set <code>esp</code> (stack pointer) to <code>ebp</code> (base pointer) <img class=lazyload src=/svg/loading.min.svg data-src=https://i.imgur.com/EWMvo2z.png data-srcset="https://i.imgur.com/EWMvo2z.png, https://i.imgur.com/EWMvo2z.png 1.5x, https://i.imgur.com/EWMvo2z.png 2x" data-sizes=auto alt=https://i.imgur.com/EWMvo2z.png title=https://i.imgur.com/EWMvo2z.png></li><li>means <code>leave</code> will destroy the stack frame</li></ul></li><li><strong><code>return</code></strong><ul><li>now as we can see the <code>return</code> is now on top of the stack.</li><li>means <code>return</code> pop itself from stack and set the <code>eip</code> (instruction pointer) to that return address</li></ul></li></ol><p>Thank You! guys for reading my blog post on <code>Binary Exploitation Basics</code>.</p><h3 id=resource>Resource</h3><ol><li><a href="https://www.youtube.com/watch?v=75gBFiFtAb8" target=_blank rel="noopener noreffer">x86 Assembly Crash Course</a>, this blog is based on this video</li><li><a href="https://pythontutor.com/visualize.html#mode=edit" target=_blank rel="noopener noreffer">Try this for Visualization of Stack and Heap By running C code</a></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 0001-01-01</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/networking_basics/ class=next rel=next title="Networking Basics">Networking Basics<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments></div></article></div></main></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{},cookieconsent:{content:{dismiss:"Got it!",link:"Learn more",message:"This website uses Cookies to improve your experience."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>